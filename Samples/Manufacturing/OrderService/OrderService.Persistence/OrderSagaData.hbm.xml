<?xml version="1.0" encoding="utf-8" ?>
<hibernate-mapping xmlns="urn:nhibernate-mapping-2.2">
  <class name="NServiceBus.Saga.ISagaEntity, NServiceBus" abstract="true">

    <id name="Id" column="Id" type="Guid">
      <generator class="assigned" />
    </id>

    <property name="Originator" column="Originator" type="String" />
    <property name="OriginalMessageId" column="OriginalMessageId" type="String" />

    <union-subclass name="OrderService.OrderSagaData, OrderService" table="OrderSagaData">

      <property name="PurchaseOrderNumber" column="PurchaseOrderNumber" type="String" />
      <property name="PartnerId" column="PartnerId" type="Guid" />
      <property name="ProvideBy" column="ProvideBy" type="DateTime" />

      <bag name="orderLines" access="field" table="OrderSagaDataLines" cascade="all-delete-orphan" lazy="false" inverse="true">
        <key column="OrderSagaDataId" />
        <one-to-many class="OrderService.OrderLine, OrderService" />
      </bag>

    </union-subclass>
    
  </class>
</hibernate-mapping>
